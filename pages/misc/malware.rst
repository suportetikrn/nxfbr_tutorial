Detectando e prevenindo ações de malware/botnet
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

One of the features of NxFilter is to be able to detect and block malware/botnet activity by analyzing DNS packets. In reality malwares and botnets are another form of network clients or server programs. This means that they are also heavily relying on DNS protocol to find their masters or peers to communicate with or the victims to attack.
For example, if you have a spambot in your network the spambot will make a lot of DNS queries for MX records of the target domains to send emails. But normally your client PC doesn't need to make MX queries unless they have a mail server running on it.
Another example would be the botnets using the 'TXT' record or other DNS records as their communication tool. These are the real world examples of malwares using DNS protocol as their communication tool.

ex1) Trojan.Spachanel was using SPF record.
ex2) W32.Morto was using TXT record.

The other method we can think of would be detecting the abnormal length of domains. When we tested top 100,000 domains by Alexa all the domains except 142 domains were shorter than 30 characters. But there are abnormal domains trying to look like some URL of a target website. This is an example from www.phishtank.com which is trying to look like a webpage of www.ebay.co.uk but actually it i s a phishing domain.

ex1) cgi.ebay.co.uk-item-css.ebay-motors.session.id-sj3mzbasf3k12z581668115.login-wpadmin-sw.buyitnow.sign-in.secure-process657943sddh53zix34235hj65rj.xml.config-page.overview.buyer-protection-jsp.wpcs.spiridus-magic.org

So detecting botnet/malware by analyzing DNS packet would be one of the effective techniques we can think of. NxFilter provides these blocking options on its policy setup.

- Max Domain Length
- Block Covert Channel
- Block Mailer Worm
- Block DNS Rebinding
- Allow 'A' Record Only

But you can say that the most effective way of preventing malware/botnet in your network would be allowing only 'A' record query from your client PC. In most cases your client PC doesn't need to make a DNS query for any other record than 'A', 'AAAA', 'PTR' , 'CNAME'.
